(this["webpackJsonpcard-game-engine"]=this["webpackJsonpcard-game-engine"]||[]).push([[0],{15:function(e,t,r){e.exports={Card:"Card_Card__1a3PF"}},16:function(e,t,r){e.exports={Hand:"Hand_Hand__2DWBX"}},17:function(e,t,r){e.exports={Scene:"Scene_Scene__MfpmQ"}},18:function(e,t,r){e.exports={Board:"Board_Board__tkmV4"}},19:function(e,t,r){e.exports=r(32)},24:function(e,t,r){},25:function(e,t,r){},32:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(9),i=r.n(c),o=(r(24),r(1)),d=r(2),p=r(4),s=r(3),u=(r(25),r(5)),l=r(8),f=function(e,t){return{type:"MOVE_CARD",x:e,y:t}},h=r(15),C=r.n(h),k=function(e){Object(p.a)(r,e);var t=Object(s.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(d.a)(r,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",Object.assign({className:C.a.Card,style:this.props.style},this.props.passProps),this.props.info.title))}}]),r}(a.a.Component),v=function(e){Object(p.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={center:0},e.focus=function(t){e.props.pickedCard||(e.props.focusCard(e.props.info),e.setState({center:t.pageX}))},e.unfocus=function(){e.props.focusCard(null)},e.mouseDown=function(t){e.props.pickCard(),e.props.moveCard(t.pageX,t.pageY)},e}return Object(d.a)(r,[{key:"render",value:function(){var e={role:"button",tabIndex:0,onMouseDown:this.mouseDown,onMouseEnter:this.focus,onMouseLeave:this.unfocus};return a.a.createElement(a.a.Fragment,null,a.a.createElement(k,{info:this.props.info,passProps:e,style:Object(l.a)(Object(l.a)({},this.props.style),{},{opacity:this.props.focused||this.props.picked?0:1,display:this.props.picked?"none":""})}),this.props.focused&&a.a.createElement(k,{info:this.props.info,style:{position:"absolute",left:this.state.center-this.props.focusedCardWidth/2,bottom:"5%",width:this.props.focusedCardWidth+"px",height:this.props.focusedCardHeight+"px",zIndex:2,pointerEvents:"none"}}))}}]),r}(a.a.Component),y=Object(u.b)((function(e){return{pickedCard:e.cards.pickedCard}}),(function(e){return{focusCard:function(t){return e(function(e){return{type:"FOCUS_CARD",card:e}}(t))},pickCard:function(){return e({type:"PICK_CARD"})},moveCard:function(t,r){return e(f(t,r))}}}))(v),m=r(16),g=r.n(m),O=function(e){Object(p.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).calculateColumn=function(t){var r=e.props.cardOverflow*t+1;return"".concat(r," / ").concat(r+e.props.cardGrid)},e.calculateRotate=function(t){t++;var r=(e.props.cardCount+1)/2;if(t===r||e.props.cardGrid<=e.props.cardOverflow)return"rotate(0)";var n=2*Math.sign(t-r)+3*Math.trunc(t-r),a=.05*Math.pow(Math.abs(t-r),3);return"rotate(".concat(n,"deg) translateY(").concat(a,"%)")},e.calculateOrigin=function(t){t++;var r=(e.props.cardCount+1)/2;return t===r?"center":t-r>0?"bottom left":"bottom right"},e}return Object(d.a)(r,[{key:"render",value:function(){var e=this,t=this.props.cards.map((function(t,r){var n,c=e.props.pickedIndex===r,i=(null===(n=e.props.focusedCard)||void 0===n?void 0:n.key)===t.key;return e.props.pickedIndex>=0&&r>e.props.pickedIndex&&r--,a.a.createElement(y,{key:t.key,info:t,focused:i,picked:c,focusedCardWidth:2.5*e.props.cardWidth,focusedCardHeight:2.5*e.props.cardHeight,style:{gridColumn:e.calculateColumn(r),transform:e.calculateRotate(r),transformOrigin:e.calculateOrigin(r),height:e.props.cardHeight}})}));return a.a.createElement("div",{className:g.a.Hand,style:{width:"".concat(this.props.cardWidth*this.props.widthRate,"px")}},t)}}]),r}(a.a.Component),b=Object(u.b)((function(e){var t=e.cards.hand.findIndex((function(t){var r;return t.key===(null===(r=e.cards.pickedCard)||void 0===r?void 0:r.key)})),r=e.cards.hand.length-(-1!==t),n=function(e){switch(e){case 1:case 2:return 7;case 3:case 4:return 4;case 5:case 6:return 3;default:return 2}}(r);return{cards:e.cards.hand,pickedIndex:t,cardCount:r,cardGrid:e.cards.cardGrid,cardOverflow:n,focusedCard:e.cards.focusedCard,cardWidth:e.cards.cardWidth,cardHeight:e.cards.cardWidth*e.cards.cardRatio,widthRate:1+(r-1)*n/e.cards.cardGrid}}))(O),x=r(17),j=r.n(x),E=r(18),R=r.n(E),w=function(e){Object(p.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).mouseUp=function(t){t.stopPropagation(),e.props.pickedCard&&e.props.putCard()},e}return Object(d.a)(r,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{onMouseUp:this.mouseUp,className:R.a.Board},this.props.board.map((function(t){return a.a.createElement(k,{key:t.key,info:t,style:{width:e.props.pickedCardWidth+"px",height:e.props.pickedCardHeight+"px"}})})))}}]),r}(a.a.Component),_=Object(u.b)((function(e){return{board:e.cards.board,pickedCard:e.cards.pickedCard,pickedCardWidth:e.cards.pickedCardWidth,pickedCardHeight:e.cards.pickedCardWidth*e.cards.cardRatio}}),(function(e){return{putCard:function(){return e({type:"PUT_CARD"})}}}))(w),A=r(7),W=function(e,t){return e+t},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W,n=[],a=null;Array.isArray(t)||(t=[t]),t=Array.from(t,(function(e){return e&&"function"!==typeof e?r:e}));var c=function(){for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];t.forEach((function(e,t){e&&void 0!==n[t]&&(c[t]=e(n[t],c[t]))})),n=c,a||(a=requestAnimationFrame((function(){a=null;var t=Object(A.a)(n);n=[],e.apply(void 0,Object(A.a)(t))})))};return c.cancel=function(){a&&(cancelAnimationFrame(a),a=null)},c},M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,r=arguments.length>2?arguments[2]:void 0;return function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];clearTimeout(r),r=setTimeout((function(){r=null,e.apply(void 0,a)}),t)}},P=function(e){Object(p.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).mouseMove=function(t){e.props.pickedCard&&(t.persist(),e.props.moveCard(t.pageX,t.pageY),e.props.resetRotation())},e.mouseUp=function(){e.props.pickedCard&&e.props.unpickCard()},e}return Object(d.a)(r,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{onMouseMove:this.mouseMove,onMouseUp:this.mouseUp,className:j.a.Scene,style:{perspectiveOrigin:this.props.perspectiveOrigin}},a.a.createElement("div",null,a.a.createElement("button",{onClick:this.props.drawCard},"Draw Card")),a.a.createElement(_,null),a.a.createElement("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"center",minWidth:"100%"}},a.a.createElement(b,null)),this.props.pickedCard&&a.a.createElement(k,{info:this.props.pickedCard,style:{position:"fixed",width:this.props.pickedCardWidth,height:this.props.pickedCardHeight,left:this.props.pickedCardPosition.x,top:this.props.pickedCardPosition.y,transform:"rotateX(".concat(this.props.pickedCardRotation.x,"deg) rotateY(").concat(this.props.pickedCardRotation.y,"deg)"),pointerEvents:"none"}})))}}]),r}(a.a.Component),I=Object(u.b)((function(e){return{pickedCard:e.cards.pickedCard,pickedCardWidth:e.cards.pickedCardWidth,pickedCardHeight:e.cards.pickedCardWidth*e.cards.cardRatio,pickedCardPosition:e.cards.pickedCardPosition,pickedCardRotation:e.cards.pickedCardRotation,perspectiveOrigin:"".concat(e.cards.perspectiveOrigin.x,"px ").concat(e.cards.perspectiveOrigin.y,"px")}}),(function(e){return{drawCard:function(){return e({type:"DRAW_CARD"})},unpickCard:function(){return e({type:"UNPICK_CARD"})},moveCard:D((function(t,r){return e(f(t,r))})),resetRotation:M((function(){e({type:"RESET_ROTATION"})}),120)}}))(P),S=function(e){Object(p.a)(r,e);var t=Object(s.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(d.a)(r,[{key:"render",value:function(){return a.a.createElement(I,null)}}]),r}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var T=r(6);function U(e,t){return Object(l.a)(Object(l.a)({},e),t)}var H={deck:Array(30).fill().map((function(e,t){return{key:t,title:"".concat(t,". card")}})),hand:[],board:[],cardGrid:6,cardWidth:100,cardRatio:1.5,focusedCard:null,pickedCard:null,pickedCardPosition:null,pickedCardRotation:{x:0,y:0},perspectiveOrigin:{x:"center",y:"center"},pickedCardWidth:120};function N(e){if(9===e.hand.length)return e;var t=Math.floor(Math.random()*e.deck.length),r=e.deck[t];return U(e,{deck:[].concat(Object(A.a)(e.deck.slice(0,t)),Object(A.a)(e.deck.slice(t+1))),hand:e.hand.concat(r)})}function X(e){return U(e,{pickedCard:e.focusedCard,focusedCard:null})}function F(e,t){var r=t.x-e.pickedCardWidth/2,n=t.y-e.pickedCardWidth*e.cardRatio/2,a=e.pickedCardPosition?r-e.pickedCardPosition.x:0,c={pickedCardPosition:{x:r,y:n},pickedCardRotation:{x:1.5*-(e.pickedCardPosition?n-e.pickedCardPosition.y:0),y:1.5*a}};if("center"===e.perspectiveOrigin.x)c.perspectiveOrigin={x:t.x,y:t.y};else{var i=e.perspectiveOrigin.x-t.x,o=e.perspectiveOrigin.y-t.y;Math.pow(i,2)+Math.pow(o,2)>Math.pow(100,2)&&(console.log("yo"),c.perspectiveOrigin={x:t.x,y:t.y})}return U(e,c)}function B(e){return U(e,{pickedCard:null,pickedCardPosition:null,pickedCardRotation:{x:0,y:0},perspectiveOrigin:{x:"center",y:"center"}})}function G(e){return 5===e.board.length?B(e):U(e,{board:e.board.concat(e.pickedCard),hand:e.hand.filter((function(t){return t.key!==e.pickedCard.key})),pickedCard:null,pickedCardPosition:null,pickedCardRotation:{x:0,y:0},perspectiveOrigin:{x:"center",y:"center"}})}var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DRAW_CARD":return N(e);case"FOCUS_CARD":return U(e,{focusedCard:t.card});case"PICK_CARD":return X(e);case"UNPICK_CARD":return B(e);case"MOVE_CARD":return F(e,t);case"RESET_ROTATION":return U(e,{pickedCardRotation:{x:0,y:0}});case"PUT_CARD":return G(e);default:return e}},K=Object(T.b)({cards:V}),Y=Object(T.c)(K,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(u.a,{store:Y},a.a.createElement(S,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.0b281ea3.chunk.js.map