(this["webpackJsonpcard-game-engine"]=this["webpackJsonpcard-game-engine"]||[]).push([[0],[,,,,,,,function(e,t,n){e.exports={Container:"Card_Container__2W8YJ",Card:"Card_Card__1a3PF",Backface:"Card_Backface__34aEB",Empty:"Card_Empty__2juuo",Egg:"Card_Egg__2rYth",Text:"Card_Text__2SDrG",Float:"Card_Float__2KMnF",Attack:"Card_Attack__7Lv0U",Health:"Card_Health__3Tn_R",Mana:"Card_Mana__zwGNW"}},,,function(e,t,n){e.exports={Egg:"Pawn_Egg__2gtQs",Float:"Pawn_Float__1nyn7",Attack:"Pawn_Attack__ryZ0e",Health:"Pawn_Health__Q6FiS"}},,,function(e,t,n){e.exports={BottomPane:"BottomPane_BottomPane__3wBf5",Container:"BottomPane_Container__29iZx"}},,,function(e,t,n){e.exports={Board:"Board_Board__tkmV4",Line:"Board_Line__3obCo"}},function(e,t,n){e.exports={Container:"Arrow_Container__1d-KN",Head:"Arrow_Head__5jCne",Piece:"Arrow_Piece__mCcN_",move:"Arrow_move__hW7DI","fade-out":"Arrow_fade-out__1V7ZA"}},,,,,function(e,t,n){e.exports={Scene:"Scene_Scene__MfpmQ"}},,function(e,t,n){e.exports=n.p+"static/media/skull.44d42c36.svg"},function(e,t,n){e.exports=n.p+"static/media/card-texture.15ee4520.jpg"},function(e,t,n){e.exports={Hand:"Hand_Hand__2DWBX"}},function(e,t,n){e.exports=n.p+"static/media/test.24636254.svg"},,function(e,t,n){e.exports=n(42)},,,,,function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"endTurn",(function(){return L})),n.d(a,"drawCard",(function(){return U})),n.d(a,"focusCard",(function(){return V})),n.d(a,"pickCard",(function(){return X})),n.d(a,"unpickCard",(function(){return Y})),n.d(a,"moveCard",(function(){return G})),n.d(a,"resetRotation",(function(){return Z})),n.d(a,"moveFakeCard",(function(){return Q})),n.d(a,"putCard",(function(){return J})),n.d(a,"setDeckPosition",(function(){return q})),n.d(a,"setPawnPositions",(function(){return $})),n.d(a,"pickPawn",(function(){return ee})),n.d(a,"focusPawn",(function(){return te})),n.d(a,"removePawn",(function(){return ne})),n.d(a,"attack",(function(){return ae})),n.d(a,"resizeWindow",(function(){return re}));var r=n(0),o=n.n(r),i=n(14),c=n.n(i),d=(n(34),n(2)),s=n(3),u=n(5),l=n(4),p=(n(35),n(1)),f=n(12),m=n(22),h=n.n(m),k=n(8),C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2?arguments[2]:void 0;return function(){for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];clearTimeout(n),n=setTimeout((function(){n=null,e.apply(void 0,r)}),t)}},y=function(e,t,n){return e>n?n:e<t?t:e};function v(e,t){return Object(p.a)(Object(p.a)({},e),t)}var w=Array(30).fill().map((function(e,t){return{key:"p".concat(t),title:"".concat(t,". card"),background:"rgb(".concat([0,0,0].map((function(e){return 256*Math.random()|0})),")"),mana:Math.floor(1+8*Math.random()),attack:Math.floor(1+7*Math.random()),health:Math.floor(1+8*Math.random())}})),g=Array(9).fill().map((function(e,t){return{key:"op".concat(t),background:"rgb(".concat([0,0,0].map((function(e){return 256*Math.random()|0})),")"),attack:Math.floor(1+7*Math.random()),health:Math.floor(1+8*Math.random())}})).map((function(e){return Object(p.a)(Object(p.a)({},e),{},{realHealth:e.health})})),b={x:15,y:0},E=.2*window.innerHeight/1.5,P={turn:!0,deck:w,hand:[],board:[],opponentBoard:g,cardGrid:6,cardWidth:E,cardRatio:1.5,focusedCard:null,pickedCard:null,pickedCardPosition:null,pickedCardRotation:b,pickedRatio:1.2,pickedCardWidth:1.2*E,fakeCardIndex:null,cardShadowColor:"white",deckPosition:{x:0,y:0},pickedPawn:null,focusedPawn:null,animation:null,arrow:null,pawnPositions:[],opponentPositions:[],handSize:".3em",focusSize:"1em",pickSize:".4em"};function O(e,t,n){var a=.2*n/e.cardRatio;return v(e,{cardWidth:a,pickedCardWidth:a*e.pickedRatio})}function _(e){var t=e.turn?{}:x(e.deck,e.hand);return v(e,Object(p.a)({turn:!e.turn,pickedCard:null,pickedCardPosition:null,pickedCardRotation:b,fakeCardIndex:null,pickedPawn:null,focusedPawn:null,board:e.board.map((function(e){return v(e,{sleeping:!1})}))},t))}function x(e,t){if(9===t.length||0===e.length)return{};var n=Math.floor(Math.random()*e.length),a=e[n];return{deck:[].concat(Object(k.a)(e.slice(0,n)),Object(k.a)(e.slice(n+1))),hand:t.concat(a)}}function S(e){return v(e,Object(p.a)({},x(e.deck,e.hand)))}function j(e){return v(e,{pickedCard:e.focusedCard,focusedCard:null})}function A(e,t){var n=t.x-e.pickedCardWidth/2,a=t.y-e.pickedCardWidth*e.cardRatio/2,r=e.pickedCardPosition?n-e.pickedCardPosition.x:0,o=e.pickedCardPosition?a-e.pickedCardPosition.y:0;return v(e,{pickedCardPosition:{x:n,y:a},pickedCardRotation:{x:b.x+y(1.5*-o,-30,30),y:b.y+y(1.5*r,-30,30)}})}function R(e){return v(e,{pickedCard:null,pickedCardPosition:null,pickedCardRotation:b,fakeCardIndex:null})}function M(e){if(5===e.board.length)return R(e);var t=v(e.pickedCard,{sleeping:!0,realHealth:e.pickedCard.health});return v(e,{board:[].concat(Object(k.a)(e.board.slice(0,e.fakeCardIndex)),[t],Object(k.a)(e.board.slice(e.fakeCardIndex))),hand:e.hand.filter((function(t){return t.key!==e.pickedCard.key})),pickedCard:null,pickedCardPosition:null,pickedCardRotation:b,fakeCardIndex:null})}function N(e,t,n){var a=e.board.find((function(e){return e.key===t}));return!(e.opponentBoard.find((function(e){return e.key===n})).realHealth<=0)&&!a.sleeping}function B(e,t){if(null===t)return v(e,{pickedPawn:null,arrow:null});var n=e.board.findIndex((function(e){return e.key===t}));return v(e,{pickedPawn:e.board[n],arrow:{from:e.pawnPositions[n],to:null}})}function T(e,t){if(null===t)return v(e,{focusedPawn:null,pickedPawn:v(e.pickedPawn,{dies:!1}),arrow:v(e.arrow,{to:null})});var n=e.opponentBoard.findIndex((function(e){return e.key===t})),a=e.opponentBoard[n];return N(e,e.pickedPawn.key,a.key)?v(e,{focusedPawn:v(a,{dies:a.realHealth-e.pickedPawn.attack<=0}),pickedPawn:v(e.pickedPawn,{dies:e.pickedPawn.realHealth-a.attack<=0}),arrow:v(e.arrow,{to:e.opponentPositions[n]})}):e}function z(e,t){return v(e,{board:e.board.filter((function(e){return e.key!==t})),opponentBoard:e.opponentBoard.filter((function(e){return e.key!==t}))})}function I(e,t,n){var a=e.arrow,r=e.board.findIndex((function(t){var n;return t.key===(null===(n=e.pickedPawn)||void 0===n?void 0:n.key)}));return r>=0&&(a=v(a,{from:t[r]})),(r=e.opponentBoard.findIndex((function(t){var n;return t.key===(null===(n=e.focusedPawn)||void 0===n?void 0:n.key)})))>=0&&(a=v(a,{to:n[r]})),v(e,{pawnPositions:t,opponentPositions:n,arrow:a})}function W(e){return v(e,{pickedPawn:null,focusedPawn:null})}function D(e,t,n){var a=e.board.find((function(e){return e.key===t})),r=e.opponentBoard.find((function(e){return e.key===n})),o=v(a,{sleeping:!0,realHealth:a.realHealth-r.attack}),i=v(r,{realHealth:r.realHealth-a.attack});return v(e,{pickedPawn:null,focusedPawn:null,animation:e.pickedPawn.key+"-"+e.focusedPawn.key,board:e.board.map((function(e){return e.key===a.key?o:e})),opponentBoard:e.opponentBoard.map((function(e){return e.key===r.key?i:e})),arrow:null})}function H(e,t,n){var a=e.board.find((function(e){return e.key===t})),r=e.opponentBoard.find((function(e){return e.key===n})),o=v(a,{health:a.health-r.attack}),i=v(r,{health:r.health-a.attack});return v(e,{board:e.board.map((function(e){return e.key===a.key?o:e})),opponentBoard:e.opponentBoard.map((function(e){return e.key===r.key?i:e}))})}function F(e){return v(e,{board:e.board.map((function(e){return e.health>0?e:v(e,{dead:!0})})),opponentBoard:e.opponentBoard.map((function(e){return e.health>0?e:v(e,{dead:!0})}))})}var K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"END_TURN":return _(e);case"DRAW_CARD":return S(e);case"FOCUS_CARD":return v(e,{focusedCard:t.card});case"PICK_CARD":return j(e);case"UNPICK_CARD":return R(e);case"MOVE_CARD":return A(e,t);case"RESET_ROTATION":return v(e,{pickedCardRotation:b});case"MOVE_FAKE_CARD":return v(e,{fakeCardIndex:t.index});case"PUT_CARD":return M(e);case"SET_DECK_POSITION":return v(e,{deckPosition:t.position});case"PICK_PAWN":return B(e,t.pawnKey);case"FOCUS_PAWN":return T(e,t.pawnKey);case"REMOVE_PAWN":return z(e,t.pawnKey);case"ATTACK_START":return D(e,t.pawnKey,t.opponentKey);case"ATTACK_CANCEL":return W(e);case"ATTACK":return H(e,t.pawnKey,t.opponentKey);case"ATTACKS_END":return F(e);case"SET_PAWN_POSITIONS":return I(e,t.pawnPositions,t.opponentPositions);case"WINDOW_RESIZE":return O(e,t.width,t.height);default:return e}},L=function(){return{type:"END_TURN"}},U=function(){return{type:"DRAW_CARD"}},V=function(e){return{type:"FOCUS_CARD",card:e}},X=function(){return{type:"PICK_CARD"}},Y=function(){return{type:"UNPICK_CARD"}},G=function(e,t){return{type:"MOVE_CARD",x:e,y:t}},Z=function(){return{type:"RESET_ROTATION"}},Q=function(e){return{type:"MOVE_FAKE_CARD",index:e}},J=function(){return{type:"PUT_CARD"}},q=function(e){return{type:"SET_DECK_POSITION",position:e}},$=function(e,t){return{type:"SET_PAWN_POSITIONS",pawnPositions:e,opponentPositions:t}},ee=function(e){return{type:"PICK_PAWN",pawnKey:e}},te=function(e){return{type:"FOCUS_PAWN",pawnKey:e}},ne=function(e){return{type:"REMOVE_PAWN",pawnKey:e}};function ae(e,t){return function(n,a){var r=a().cards;if(!N(r,r.pickedPawn.key,r.focusedPawn.key))return n({type:"ATTACK_CANCEL"});var o=[r.pickedPawn,r.focusedPawn],i=o[0],c=o[1];n({type:"ATTACK_START",pawnKey:i.key,opponentKey:c.key}),e.style.transform="none";var d=e.getBoundingClientRect(),s=t.getBoundingClientRect(),u=Math.atan2(s.left-d.left,d.top-s.top),l=Math.hypot(s.top+s.height/2-d.top,s.left-d.left);e.animate([{transform:"none",zIndex:10},{offset:.5,transform:"rotate(".concat(u,"rad) translateY(").concat(.2*l,"px)")},{offset:Math.min(.75,.5+l/8e3),transform:"rotate(".concat(u,"rad) translateY(").concat(-l,"px)")},{offset:Math.min(1,.5+6*l/8e3),transform:"rotate(".concat(u,"rad) translateY(0px)"),zIndex:10}],800).onfinish=function(){n({type:"ATTACK",pawnKey:i.key,opponentKey:c.key}),a().cards.animation===i.key+"-"+c.key&&n({type:"ATTACKS_END"})}}}var re=function(e,t){return{type:"WINDOW_RESIZE",width:e,height:t}},oe=Object(p.a)({},a),ie=n(6),ce=function(e,t){return e+t},de=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ce,a=[],r=null;Array.isArray(t)||(t=[t]),t=Array.from(t,(function(e){return e&&"function"!==typeof e?n:e}));var o=function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];t.forEach((function(e,t){e&&void 0!==a[t]&&(o[t]=e(a[t],o[t]))})),a=o,r||(r=requestAnimationFrame((function(){r=null;var t=Object(k.a)(a);a=[],e.apply(void 0,Object(k.a)(t))})))};return o.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},o},se=n(16),ue=n.n(se),le=n(10),pe=n.n(le),fe=n(24),me=n.n(fe),he=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).mouseDown=function(){var t;e.props.opponent||(null===(t=e.props.info)||void 0===t?void 0:t.sleeping)||!e.props.turn||e.props.pickPawn(e.props.info.key)},e.mouseUp=function(t){e.props.opponent&&e.props.pickedPawn&&e.props.turn&&e.props.attack(e.ref.current)},e.mouseEnter=function(t){e.props.opponent&&e.props.pickedPawn&&e.props.focusPawn(e.props.info.key)},e.mouseLeave=function(t){e.props.opponent&&e.props.pickedPawn&&e.props.focusPawn(null)},e.ref=o.a.createRef(),e}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(){var e,t=this;(null===(e=this.props.info)||void 0===e?void 0:e.dead)&&(this.ref.current.animate([{opacity:1},{opacity:0}],{duration:800,fill:"forwards"}).onfinish=function(){return t.props.removePawn(t.props.info.key)})}},{key:"render",value:function(){var e,t,n,a,r,i,c=(null===(e=this.props.focusedPawn)||void 0===e?void 0:e.key)===(null===(t=this.props.info)||void 0===t?void 0:t.key)&&(null===(n=this.props.focusedPawn)||void 0===n?void 0:n.dies)||this.props.picked&&(null===(a=this.props.pickedPawn)||void 0===a?void 0:a.dies);return o.a.createElement("div",{role:"button",tabIndex:0,ref:this.ref,className:pe.a.Egg,style:Object(p.a)(Object(p.a)({},this.props.style),{},{background:null===(r=this.props.info)||void 0===r?void 0:r.background,transform:this.props.picked&&"scale(1.2, 1.2)",boxShadow:!this.props.turn||this.props.noContent||this.props.opponent||((null===(i=this.props.info)||void 0===i?void 0:i.sleeping)?this.props.picked&&"0 4px 2px 0 rgba(0,0,0,0.5)":"0 0 8px 4px green")}),onMouseDown:this.mouseDown,onMouseUp:this.mouseUp,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},this.props.noContent||o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:pe.a.Float+" "+pe.a.Attack},this.props.info.attack),o.a.createElement("div",{className:pe.a.Float+" "+pe.a.Health},this.props.info.health),c&&o.a.createElement("img",{alt:"dies",src:me.a})))}}]),n}(o.a.Component),ke=Object(ie.b)((function(e){return{focusedPawn:e.cards.focusedPawn,pickedPawn:e.cards.pickedPawn,turn:e.cards.turn}}),(function(e){return{pickPawn:function(t){return e(oe.pickPawn(t))},focusPawn:function(t){return e(oe.focusPawn(t))},removePawn:function(t){return e(oe.removePawn(t))}}}))(he);var Ce=Object(ie.b)((function(e){return{board:e.cards.board,opponentBoard:e.cards.opponentBoard,pickedCard:e.cards.pickedCard,pickedCardWidth:e.cards.pickedCardWidth,pickedCardHeight:e.cards.pickedCardWidth*e.cards.cardRatio,fakeCard:null!==e.cards.fakeCardIndex,fakeCardOrder:2*e.cards.fakeCardIndex-1,cardSize:e.cards.pickSize,pickedPawn:e.cards.pickedPawn,focusedPawn:e.cards.focusedPawn}}),(function(e){return{moveFakeCard:function(t){return e(oe.moveFakeCard(t))},putCard:function(){return e(oe.putCard())},attack:function(t,n){return e(oe.attack(t,n))},setPawnPositions:function(t,n){return e(oe.setPawnPositions(t,n))}}}))((function(e){var t=Object(r.useState)([]),n=Object(f.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)([]),d=Object(f.a)(c,2),s=d[0],u=d[1],l=Object(r.useRef)(null),p=Object(r.useRef)(null);Object(r.useEffect)((function(){var e=de((function(){i([]),u([])}));return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var m=e.setPawnPositions;Object(r.useEffect)((function(){a[e.board.length]&&s[e.opponentBoard.length]&&m(a[e.board.length],s[e.opponentBoard.length])}),[s,a,e.board.length,e.opponentBoard.length,m]),Object(r.useEffect)((function(){if(!a[e.board.length]){var t=Array.from(l.current.children).map((function(e){var t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}));i((function(n){var a=Object(k.a)(n);return a[e.board.length]=t,Array.from(a)}))}}),[a,e.board.length]),Object(r.useEffect)((function(){if(!s[e.opponentBoard.length]){var t=Array.from(p.current.children).map((function(e){var t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}));u((function(n){var a=Object(k.a)(n);return a[e.opponentBoard.length]=t,Array.from(a)}))}}),[s,e.opponentBoard.length]);var h=de((function(t){var n=a[e.board.length].findIndex((function(e){var n=e.x;return t.pageX<n}));-1===n&&(n=a[e.board.length].length),e.moveFakeCard(n)})),C=function(t){var n=l.current.children[e.board.findIndex((function(t){return t.key===e.pickedPawn.key}))];e.attack(n,t)},y=e.fakeCard&&o.a.createElement(ke,{noContent:!0,style:{order:e.fakeCardOrder,fontSize:e.cardSize}});return o.a.createElement("div",{className:ue.a.Board,onMouseMove:function(t){e.pickedCard&&5!==e.board.length&&(t.persist(),h(t))},onMouseUp:function(t){e.pickedCard&&(t.stopPropagation(),h.cancel(),e.putCard())},onMouseLeave:function(){e.pickedCard&&5!==e.board.length&&(h.cancel(),e.moveFakeCard(null))}},o.a.createElement("div",{ref:p,className:ue.a.Line,style:{borderBottom:"3px dotted gray"}},e.opponentBoard.map((function(t){return o.a.createElement(ke,{opponent:!0,attack:C,key:t.key,info:t,style:{fontSize:e.cardSize}})}))),o.a.createElement("div",{ref:l,className:ue.a.Line},e.board.map((function(t,n){var a;return o.a.createElement(ke,{key:t.key,info:t,picked:(null===(a=e.pickedPawn)||void 0===a?void 0:a.key)===t.key,style:{order:2*n,fontSize:e.cardSize}})})),y))})),ye=n(7),ve=n.n(ye),we=n(25),ge=n.n(we),be=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e;return o.a.createElement("div",{className:ve.a.Container,style:this.props.containerStyle},o.a.createElement("div",Object.assign({className:"".concat(ve.a.Card," ").concat(this.props.noContent?ve.a.Empty:""),style:this.props.style},this.props.passProps),this.props.noContent||o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:ve.a.Egg,style:{background:this.props.info.background}}),o.a.createElement("div",{className:ve.a.Text},null===(e=this.props.info)||void 0===e?void 0:e.title),o.a.createElement("div",{className:ve.a.Float+" "+ve.a.Attack},this.props.info.attack),o.a.createElement("div",{className:ve.a.Float+" "+ve.a.Health},this.props.info.health),o.a.createElement("div",{className:ve.a.Float+" "+ve.a.Mana},this.props.info.mana)),this.props.hasBackface&&o.a.createElement("div",{className:ve.a.Backface,style:{background:"url(".concat(ge.a,")"),backgroundSize:"cover",backgroundRepeat:"repeat"}})))}}]),n}(o.a.Component),Ee=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={center:0},e.focus=function(){e.props.pickedCard||e.props.focusCard(e.props.info)},e.unfocus=function(){e.props.focusCard(null)},e.mouseDown=function(t){e.props.turn&&(e.props.pickCard(),e.props.moveCard(t.pageX,t.pageY))},e}return Object(s.a)(n,[{key:"render",value:function(){var e={role:"button",tabIndex:0,onMouseDown:this.mouseDown,onMouseEnter:this.focus,onMouseLeave:this.unfocus,ref:this.props.setRef};return o.a.createElement(o.a.Fragment,null,o.a.createElement(be,{info:this.props.info,passProps:e,hasBackface:this.props.hasBackface,containerStyle:Object(p.a)(Object(p.a)({},this.props.containerStyle),{},{display:this.props.picked?"none":""}),style:Object(p.a)(Object(p.a)({},this.props.style),{},{opacity:this.props.focused?0:1})}),this.props.focused&&o.a.createElement(o.a.Fragment,null,o.a.createElement(be,{noContent:!0,containerStyle:Object(p.a)(Object(p.a)({},this.props.containerStyle),{},{pointerEvents:"none"}),style:this.props.style}),o.a.createElement(be,{info:this.props.info,containerStyle:Object(p.a)(Object(p.a)({},this.props.containerStyle),{},{fontSize:this.props.focusedSize,position:"absolute",transform:"none",transformOrigin:"center",left:"-50%",bottom:"90%",pointerEvents:"none",zIndex:4})})))}}]),n}(o.a.Component),Pe=Object(ie.b)((function(e){return{pickedCard:e.cards.pickedCard,focusedSize:e.cards.focusSize,turn:e.cards.turn}}),(function(e){return{focusCard:function(t){return e(oe.focusCard(t))},pickCard:function(){return e(oe.pickCard())},moveCard:function(t,n){return e(oe.moveCard(t,n))}}}))(Ee),Oe=n(26),_e=n.n(Oe),xe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={lastCard:null,lastSize:0},e.setRef=function(t){e.setState({lastCard:t})},e.calculateColumn=function(t){var n=e.props.cardOverflow*t+1;return"".concat(n," / ").concat(n+e.props.cardGrid)},e.calculateRotate=function(t){t++;var n=(e.props.cardCount+1)/2;if(t===n||e.props.cardGrid<=e.props.cardOverflow)return"rotate(0)";var a=2*Math.sign(t-n)+3*Math.trunc(t-n),r=.05*Math.pow(Math.abs(t-n),3);return"rotate(".concat(a,"deg) translateY(").concat(r,"%)")},e.calculateOrigin=function(t){t++;var n=(e.props.cardCount+1)/2;return t===n?"center":t-n>0?"bottom left":"bottom right"},e}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(){if(this.props.cards.length<this.state.lastSize)return this.setState({lastCard:null,lastSize:this.props.cards.length});if(this.state.lastCard&&this.props.cards.length!==this.state.lastSize){var e=this.state.lastCard,t=e.getBoundingClientRect();e.parentNode.animate([{position:"absolute",left:this.props.deckPosition.x-t.left+"px",bottom:-(this.props.deckPosition.y-t.top)+"px",transform:"none",fontSize:this.props.size},{offset:.25,left:"-50%",bottom:"105%",transform:"none",fontSize:"calc(2.5 * ".concat(this.props.size,")")},{offset:.9,left:"-50%",bottom:"105%",transform:"none",fontSize:"calc(2.5 * ".concat(this.props.size,")")},{position:"absolute",left:"0px",bottom:"0px"}],2500),e.animate([{transform:"rotateX(0deg)  rotateY(180deg)"},{transform:"rotateX(45deg)  rotateY(225deg)"},{transform:"rotateX(90deg) rotateY(270deg)"},{offset:.25,transform:"rotateX(0deg)  rotateY(360deg)"},{offset:.9,transform:"rotateX(0deg)  rotateY(360deg)"},{transform:"rotateX(0deg)  rotateY(360deg)"}],2500),this.setState({lastCard:null,lastSize:this.props.cards.length})}}},{key:"render",value:function(){var e=this,t=this.props.cards.map((function(t,n){var a,r=e.props.pickedIndex===n,i=(null===(a=e.props.focusedCard)||void 0===a?void 0:a.key)===t.key,c=n===e.props.cards.length-1;return e.props.pickedIndex>=0&&n>e.props.pickedIndex&&n--,o.a.createElement(Pe,Object.assign({},c?{setRef:e.setRef,hasBackface:!0}:{},{key:t.key,info:t,focused:i,picked:r,containerStyle:{fontSize:e.props.size,gridColumn:e.calculateColumn(n),transform:e.calculateRotate(n),transformOrigin:e.calculateOrigin(n),zIndex:3,perspective:"500px",marginBottom:"-30%"},style:{border:"2px solid black"}}))}));return o.a.createElement("div",{className:_e.a.Hand,style:{gridTemplateColumns:"repeat(".concat(this.props.columnCount,", 1fr)")}},o.a.createElement(be,{noContent:!0,containerStyle:{fontSize:this.props.size,gridColumn:this.calculateColumn(0),opacity:0,marginBottom:"-30%"}}),t)}}]),n}(o.a.Component),Se=Object(ie.b)((function(e){var t=e.cards.hand.findIndex((function(t){var n;return t.key===(null===(n=e.cards.pickedCard)||void 0===n?void 0:n.key)})),n=e.cards.hand.length-(-1!==t),a=function(e){switch(e){case 1:case 2:return 7;case 3:case 4:return 4;case 5:case 6:return 3;default:return 2}}(n);return{cards:e.cards.hand,pickedIndex:t,cardCount:n,cardGrid:e.cards.cardGrid,cardOverflow:a,focusedCard:e.cards.focusedCard,cardWidth:e.cards.cardWidth,cardHeight:e.cards.cardWidth*e.cards.cardRatio,columnCount:e.cards.cardGrid+(n-1)*a,deckPosition:e.cards.deckPosition,size:e.cards.handSize}}))(xe),je=n(13),Ae=n.n(je),Re=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).setRef=function(t){e.card=t},e.setPosition=function(){var t=e.card.getBoundingClientRect();e.props.setDeckPosition({x:t.left,y:t.top})},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.setPosition(),this._setPosition=de(this.setPosition),window.addEventListener("resize",this._setPosition)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._setPosition)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(be,{hasBackface:!0,noContent:!0,passProps:{ref:this.setRef},containerStyle:{marginBottom:"0.7rem",boxShadow:this.props.boxShadow,fontSize:this.props.size,paddingTop:0},style:{border:"none",transform:"rotateY(180deg)"}}))}}]),n}(o.a.Component),Me=function(e,t){var n=t<10?t:Math.floor(Math.max(10,t/2));return Array(n).fill().map((function(t,n){var a=n%2===0?e:"0 0.65px";return n=Math.floor(n/2)+1,"-".concat(n,"px ").concat(n,"px ").concat(a)})).join()},Ne=Object(ie.b)((function(e){return{cardWidth:e.cards.cardWidth,cardHeight:e.cards.cardWidth*e.cards.cardRatio,empty:0===e.cards.deck.length,boxShadow:Me(e.cards.cardShadowColor,e.cards.deck.length),size:e.cards.handSize}}),(function(e){return{drawCard:function(){return e(oe.drawCard())},unpickCard:function(){return e(oe.unpickCard())},setDeckPosition:function(t){return e(oe.setDeckPosition(t))}}}))(Re),Be=n(27),Te=n.n(Be),ze=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:Ae.a.BottomPane},o.a.createElement("div",{className:Ae.a.Container}," MANA STUFF "),o.a.createElement("div",{className:Ae.a.Container,style:{zIndex:2,display:"flex",flexFlow:"column nowrap",alignItems:"center",gap:"0.5em"}},o.a.createElement("img",{alt:"CHAR",src:Te.a,style:{border:"3px solid brown",borderRadius:"50% 50% 0 0",padding:"0.2em",width:"100px",height:"120px"}}),o.a.createElement(Se,null)),o.a.createElement("div",{className:Ae.a.Container},o.a.createElement(Ne,null))))}}]),n}(o.a.Component),Ie=n(17),We=n.n(Ie);var De=function(e){var t=e.fillColor||"#3975cc";return o.a.createElement("svg",{className:e.className,version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"135.6984276372506 12.427102964159928 441.30424657534456 477.9602173501391"},o.a.createElement("defs",null,o.a.createElement("path",{d:"M273.46 221.7C275.42 221.7 277 223.28 277 225.24C277 234.59 277 259.13 277 268.48C277 270.44 275.42 272.02 273.46 272.02C246.41 272.02 168.79 272.02 141.73 272.02C139.78 272.02 138.2 270.44 138.2 268.48C138.2 259.13 138.2 234.59 138.2 225.24C138.2 223.28 139.78 221.7 141.73 221.7C168.79 221.7 246.41 221.7 273.46 221.7Z",id:"bTrGSnVf2"}),o.a.createElement("path",{d:"M570.47 221.7C572.42 221.7 574 223.28 574 225.24C574 234.59 574 259.13 574 268.48C574 270.44 572.42 272.02 570.47 272.02C543.41 272.02 465.79 272.02 438.74 272.02C436.79 272.02 435.2 270.44 435.2 268.48C435.2 259.13 435.2 234.59 435.2 225.24C435.2 223.28 436.79 221.7 438.74 221.7C465.79 221.7 543.41 221.7 570.47 221.7Z",id:"dtPQlm4EN"}),o.a.createElement("path",{d:"M431.61 435C433.65 435 435.3 436.65 435.3 438.68C435.3 448.42 435.3 473.96 435.3 483.71C435.3 485.74 433.65 487.39 431.61 487.39C400.69 487.39 311.6 487.39 280.68 487.39C278.64 487.39 277 485.74 277 483.71C277 473.96 277 448.42 277 438.68C277 436.65 278.64 435 280.68 435C311.6 435 400.69 435 431.61 435Z",id:"aQCCizSuh"}),o.a.createElement("path",{d:"M140.66 221.66L356.3 14.93L571.92 221.68L435.22 221.67L435.21 440.93L276.99 440.92L277 221.67L140.66 221.66Z",id:"c1soVoUXff"})),o.a.createElement("g",null,o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#c1soVoUXff",opacity:"1",fill:t,fillOpacity:"1"}),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#c1soVoUXff",opacity:"1",fillOpacity:"0",strokeLinejoin:"round",stroke:"#000000",strokeWidth:"5",strokeOpacity:"1"}))),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#bTrGSnVf2",opacity:"1",fill:t,fillOpacity:"1"}),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#bTrGSnVf2",opacity:"1",fillOpacity:"0",stroke:"#000000",strokeWidth:"5",strokeOpacity:"1"}))),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#dtPQlm4EN",opacity:"1",fill:t,fillOpacity:"1"}),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#dtPQlm4EN",opacity:"1",fillOpacity:"0",stroke:"#000000",strokeWidth:"5",strokeOpacity:"1"}))),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#aQCCizSuh",opacity:"1",fill:t,fillOpacity:"1"}),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#aQCCizSuh",opacity:"1",fillOpacity:"0",stroke:"#000000",strokeWidth:"5",strokeOpacity:"1"})))))};var He=function(e){var t=e.fillColor||"#3975cc";return o.a.createElement("svg",{className:e.className,version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",preserveAspectRatio:"xMidYMid meet",viewBox:"191.12637362637366 187.82967032967 163.8 257.8900000000002"},o.a.createElement("defs",null,o.a.createElement("path",{d:"M340.84 390.33C346.96 390.33 351.93 395.29 351.93 401.42C351.93 409.68 351.93 423.37 351.93 431.63C351.93 437.76 346.96 442.72 340.84 442.72C311.4 442.72 234.16 442.72 204.71 442.72C198.59 442.72 193.63 437.76 193.63 431.63C193.63 423.37 193.63 409.68 193.63 401.42C193.63 395.29 198.59 390.33 204.71 390.33C234.16 390.33 311.4 390.33 340.84 390.33Z",id:"bVoGsCJqj"}),o.a.createElement("path",{d:"M341.14 190.33C347.1 190.33 351.93 195.16 351.93 201.12C351.93 242.76 351.93 356.9 351.93 398.54C351.93 404.5 347.1 409.33 341.14 409.33C311.63 409.33 233.92 409.33 204.42 409.33C198.46 409.33 193.63 404.5 193.63 398.54C193.63 356.9 193.63 242.76 193.63 201.12C193.63 195.16 198.46 190.33 204.42 190.33C233.92 190.33 311.63 190.33 341.14 190.33Z",id:"bRVC48mdV"})),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#bRVC48mdV",opacity:"1",fill:t,fillOpacity:" 1"}),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#bRVC48mdV",opacity:"1",fillOpacity:"0",stroke:"#000000",strokeWidth:"5",strokeOpacity:"1"}))),o.a.createElement("g",null,o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#bVoGsCJqj",opacity:"1",fill:t,fillOpacity:"1"}),o.a.createElement("g",null,o.a.createElement("use",{xlinkHref:"#bVoGsCJqj",opacity:"1",fillOpacity:"0",stroke:"#000000",strokeWidth:"5",strokeOpacity:"1"})))))},Fe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=[this.props.from,this.props.to],t=e[0],n=t.x,a=t.y,r=e[1],i=r.x,c=r.y,d=Math.hypot(i-n,c-a),s=Math.atan2(n-i,c-a),u=Math.max(1,Math.floor(d/80));return o.a.createElement("div",{className:We.a.Container,style:{left:n+"px",top:a+"px",height:d+"px",transform:"translateX(-50%) rotate(".concat(s,"rad)")}},new Array(u).fill().map((function(e,t){return o.a.createElement(He,{key:u+"-"+t,className:We.a.Piece})})),o.a.createElement(De,{className:We.a.Head}))}}]),n}(o.a.Component);var Ke=Object(ie.b)((function(e){return{pickedCard:e.cards.pickedCard,pickedCardPosition:e.cards.pickedCardPosition,pickedCardRotation:"rotateX(".concat(e.cards.pickedCardRotation.x,"deg) rotateY(").concat(e.cards.pickedCardRotation.y,"deg)"),pickedSize:e.cards.pickSize,pickedPawn:e.cards.pickedPawn,turn:e.cards.turn,arrow:e.cards.arrow}}),(function(e){return{endTurn:function(){return e(oe.endTurn())},drawCard:function(){return e(oe.drawCard())},unpickCard:function(){return e(oe.unpickCard())},moveCard:de((function(t,n){return e(oe.moveCard(t,n))})),resetRotation:C((function(){e(oe.resetRotation())}),120),unpickPawn:function(){return e(oe.pickPawn(null))}}}))((function(e){var t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],i=n[1];Object(r.useEffect)((function(){if(e.turn)for(var t=0;t<3;t++)setTimeout(e.drawCard,500*(t+1))}),[]),Object(r.useEffect)((function(){var t;(null===(t=e.arrow)||void 0===t?void 0:t.from)&&!e.arrow.to?i(Object(p.a)({},e.arrow.from)):i(null)}),[e.arrow]);var c=de((function(e,t){return i({x:e,y:t})}));return o.a.createElement(o.a.Fragment,null,e.arrow&&(e.arrow.to||a)&&o.a.createElement(Fe,{from:e.arrow.from,to:e.arrow.to||a}),o.a.createElement("div",{onMouseMove:function(t){var n;(null===(n=e.arrow)||void 0===n?void 0:n.from)&&!e.arrow.to&&c(t.pageX,t.pageY),e.pickedCard&&(t.persist(),e.moveCard(t.pageX,t.pageY),e.resetRotation())},onMouseUp:function(){e.pickedCard?e.unpickCard():e.pickedPawn&&e.unpickPawn()},className:h.a.Scene},o.a.createElement("div",null,o.a.createElement("button",{onClick:e.endTurn},e.turn?"End Turn":"Not Your Turn")),o.a.createElement(Ce,null),o.a.createElement(ze,null)),e.pickedCard&&o.a.createElement(be,{info:e.pickedCard,containerStyle:{fontSize:e.pickedSize,position:"fixed",left:e.pickedCardPosition.x,top:e.pickedCardPosition.y,pointerEvents:"none",zIndex:10,perspective:"500px"},style:{transform:e.pickedCardRotation}}))})),Le=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return o.a.createElement(Ke,null)}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ue=n(9),Ve=Object(Ue.c)({cards:K}),Xe=n(28),Ye=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ue.d,Ge=Object(Ue.e)(Ve,Ye(Object(Ue.a)(Xe.a)));window.addEventListener("resize",de((function(){Ge.dispatch(oe.resizeWindow(window.innerWidth,window.innerHeight))}))),c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ie.a,{store:Ge},o.a.createElement(Le,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[29,1,2]]]);
//# sourceMappingURL=main.2c7e9b21.chunk.js.map