(this["webpackJsonpcard-game-engine"]=this["webpackJsonpcard-game-engine"]||[]).push([[0],[,,,,,,,,,function(t,e,r){t.exports={BottomPane:"BottomPane_BottomPane__3wBf5",Container:"BottomPane_Container__29iZx"}},,function(t,e,r){t.exports={Card:"Card_Card__1a3PF",Backface:"Card_Backface__34aEB",Empty:"Card_Empty__2juuo"}},,,,,function(t,e,r){t.exports={Scene:"Scene_Scene__MfpmQ"}},,function(t,e,r){t.exports={Board:"Board_Board__tkmV4"}},function(t,e,r){t.exports={Hand:"Hand_Hand__2DWBX"}},function(t,e,r){t.exports=r(33)},,,,,function(t,e,r){},function(t,e,r){},,,,,,,function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"drawCard",(function(){return C})),r.d(n,"focusCard",(function(){return m})),r.d(n,"pickCard",(function(){return k})),r.d(n,"unpickCard",(function(){return v})),r.d(n,"moveCard",(function(){return g})),r.d(n,"resetRotation",(function(){return y})),r.d(n,"moveFakeCard",(function(){return b})),r.d(n,"putCard",(function(){return O})),r.d(n,"setDeckPosition",(function(){return x}));var a=r(0),o=r.n(a),i=r(10),c=r.n(i),d=(r(25),r(1)),s=r(2),p=r(4),u=r(3),l=(r(26),r(16)),h=r.n(l),f=r(6),C=function(){return{type:"DRAW_CARD"}},m=function(t){return{type:"FOCUS_CARD",card:t}},k=function(){return{type:"PICK_CARD"}},v=function(){return{type:"UNPICK_CARD"}},g=function(t,e){return{type:"MOVE_CARD",x:t,y:e}},y=function(){return{type:"RESET_ROTATION"}},b=function(t){return{type:"MOVE_FAKE_CARD",index:t}},O=function(){return{type:"PUT_CARD"}},x=function(t){return{type:"SET_DECK_POSITION",position:t}},w=Object(f.a)({},n),E=r(5),_=r(7),j=function(t,e){return t+e},R=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,n=[],a=null;Array.isArray(e)||(e=[e]),e=Array.from(e,(function(t){return t&&"function"!==typeof t?r:t}));var o=function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];e.forEach((function(t,e){t&&void 0!==n[e]&&(o[e]=t(n[e],o[e]))})),n=o,a||(a=requestAnimationFrame((function(){a=null;var e=Object(_.a)(n);n=[],t.apply(void 0,Object(_.a)(e))})))};return o.cancel=function(){a&&(cancelAnimationFrame(a),a=null)},o},P=r(11),S=r.n(P),A=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){return Object(d.a)(this,r),e.apply(this,arguments)}return Object(s.a)(r,[{key:"render",value:function(){var t;return o.a.createElement("div",{style:this.props.containerStyle},o.a.createElement("div",Object.assign({className:"".concat(S.a.Card," ").concat(this.props.empty?S.a.Empty:""),style:this.props.style},this.props.passProps),null===(t=this.props.info)||void 0===t?void 0:t.title,this.props.hasBackface&&o.a.createElement("div",{className:S.a.Backface},"BACKFACE")))}}]),r}(o.a.Component),W=r(18),D=r.n(W),M=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){var t;Object(d.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).state={columns:[]},t.ref=o.a.createRef(),t.setColumns=R((function(){var e=Array.from(t.ref.current.children).map((function(t){var e=t.getBoundingClientRect();return e.left+e.width/2}));t.setState({columns:e})})),t.mouseUp=function(e){e.stopPropagation(),t.props.pickedCard&&(t.orderFakeCard.cancel(),t.props.putCard())},t.orderFakeCard=R((function(e){var r=t.state.columns.findIndex((function(t){return e.pageX<t}));-1===r&&(r=t.state.columns.length),t.props.moveFakeCard(r)})),t.mouseMove=function(e){t.state.columns.length&&t.props.pickedCard&&5!==t.props.board.length&&(e.persist(),t.orderFakeCard(e))},t.mouseLeave=function(){t.state.columns.length&&t.props.pickedCard&&5!==t.props.board.length&&(t.orderFakeCard.cancel(),t.props.moveFakeCard(null))},t}return Object(s.a)(r,[{key:"componentDidUpdate",value:function(){this.props.board.length!==this.state.columns.length&&this.setColumns()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setColumns)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setColumns)}},{key:"render",value:function(){var t=this,e=this.props.fakeCard&&o.a.createElement(A,{empty:!0,key:"fakeCard",containerStyle:{order:this.props.fakeCardOrder},style:{width:this.props.pickedCardWidth+"px",height:this.props.pickedCardHeight+"px"}});return o.a.createElement("div",{ref:this.ref,onMouseMove:this.mouseMove,onMouseUp:this.mouseUp,onMouseLeave:this.mouseLeave,className:D.a.Board},this.props.board.map((function(e,r){return o.a.createElement(A,{key:e.key,info:e,containerStyle:{order:2*r},style:{width:t.props.pickedCardWidth+"px",height:t.props.pickedCardHeight+"px"}})})),e)}}]),r}(o.a.Component),I=Object(E.b)((function(t){return{board:t.cards.board,pickedCard:t.cards.pickedCard,pickedCardWidth:t.cards.pickedCardWidth,pickedCardHeight:t.cards.pickedCardWidth*t.cards.cardRatio,fakeCard:null!==t.cards.fakeCardIndex,fakeCardOrder:2*t.cards.fakeCardIndex-1}}),(function(t){return{moveFakeCard:function(e){return t(w.moveFakeCard(e))},putCard:function(){return t(w.putCard())}}}))(M),B=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,r=arguments.length>2?arguments[2]:void 0;return function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];clearTimeout(r),r=setTimeout((function(){r=null,t.apply(void 0,a)}),e)}},H=function(t,e,r){return t>r?r:t<e?e:t},F=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){var t;Object(d.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).state={center:0},t.focus=function(e){t.props.pickedCard||(t.props.focusCard(t.props.info),t.setState({center:e.pageX}))},t.unfocus=function(){t.props.focusCard(null)},t.mouseDown=function(e){t.props.pickCard(),t.props.moveCard(e.pageX,e.pageY)},t}return Object(s.a)(r,[{key:"render",value:function(){var t={role:"button",tabIndex:0,onMouseDown:this.mouseDown,onMouseEnter:this.focus,onMouseLeave:this.unfocus,ref:this.props.setRef};return o.a.createElement(o.a.Fragment,null,o.a.createElement(A,{info:this.props.info,passProps:t,hasBackface:this.props.hasBackface,containerStyle:this.props.containerStyle,style:Object(f.a)(Object(f.a)({},this.props.style),{},{opacity:this.props.focused?0:1,display:this.props.picked?"none":""})}),this.props.focused&&o.a.createElement(A,{info:this.props.info,containerStyle:Object(f.a)(Object(f.a)({},this.props.containerStyle),{},{position:"relative",transform:"none",transformOrigin:"center",left:"-75%",bottom:"225%",pointerEvents:"none",zIndex:4}),style:{width:"250%",height:"250%"}}))}}]),r}(o.a.Component),N=Object(E.b)((function(t){return{pickedCard:t.cards.pickedCard}}),(function(t){return{focusCard:function(e){return t(w.focusCard(e))},pickCard:function(){return t(w.pickCard())},moveCard:function(e,r){return t(w.moveCard(e,r))}}}))(F),T=r(19),U=r.n(T),X=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){var t;Object(d.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).state={lastCard:null,lastSize:0},t.setRef=function(e){t.setState({lastCard:e})},t.calculateColumn=function(e){var r=t.props.cardOverflow*e+1;return"".concat(r," / ").concat(r+t.props.cardGrid)},t.calculateRotate=function(e){e++;var r=(t.props.cardCount+1)/2;if(e===r||t.props.cardGrid<=t.props.cardOverflow)return"rotate(0)";var n=2*Math.sign(e-r)+3*Math.trunc(e-r),a=.05*Math.pow(Math.abs(e-r),3);return"rotate(".concat(n,"deg) translateY(").concat(a,"%)")},t.calculateOrigin=function(e){e++;var r=(t.props.cardCount+1)/2;return e===r?"center":e-r>0?"bottom left":"bottom right"},t}return Object(s.a)(r,[{key:"componentDidUpdate",value:function(){if(this.props.cards.length<this.state.lastSize)return this.setState({lastCard:null,lastSize:this.props.cards.length});if(this.state.lastCard&&this.props.cards.length!==this.state.lastSize){var t=this.state.lastCard,e=t.getBoundingClientRect();t.parentNode.animate([{position:"relative",left:this.props.deckPosition.x-e.left+"px",bottom:-(this.props.deckPosition.y-e.top)+"px",transform:"none",width:this.props.cardWidth+"px",height:this.props.cardHeight+"px"},{offset:.25,position:"relative",left:"-50%",bottom:"105%",transform:"none",width:2.5*this.props.cardWidth+"px",height:2.5*this.props.cardHeight+"px"},{offset:.9,position:"relative",left:"-50%",bottom:"105%",transform:"none",width:2.5*this.props.cardWidth+"px",height:2.5*this.props.cardHeight+"px"},{position:"relative",left:"0px",bottom:"0px"}],2500),t.animate([{transformOrigin:"center",transform:"rotateX(0deg)  rotateY(180deg)",width:this.props.cardWidth+"px",height:this.props.cardHeight+"px"},{transform:"rotateX(45deg)  rotateY(225deg)"},{transform:"rotateX(90deg) rotateY(270deg)"},{offset:.25,transform:"rotateX(0deg)  rotateY(360deg)",width:2.5*this.props.cardWidth+"px",height:2.5*this.props.cardHeight+"px"},{transformOrigin:"center",offset:.9,transform:"rotateX(0deg)  rotateY(360deg)",width:2.5*this.props.cardWidth+"px",height:2.5*this.props.cardHeight+"px"},{transform:"rotateX(0deg)  rotateY(360deg)",width:this.props.cardWidth+"px",height:this.props.cardHeight+"px"}],2500),this.setState({lastCard:null,lastSize:this.props.cards.length})}}},{key:"render",value:function(){var t=this,e=this.props.cards.map((function(e,r){var n,a=t.props.pickedIndex===r,i=(null===(n=t.props.focusedCard)||void 0===n?void 0:n.key)===e.key,c=r===t.props.cards.length-1;return t.props.pickedIndex>=0&&r>t.props.pickedIndex&&r--,o.a.createElement(N,Object.assign({},c?{setRef:t.setRef,hasBackface:!0}:{},{key:e.key,info:e,focused:i,picked:a,focusedCardWidth:2.5*t.props.cardWidth,focusedCardHeight:2.5*t.props.cardHeight,containerStyle:{gridColumn:t.calculateColumn(r),transform:t.calculateRotate(r),transformOrigin:t.calculateOrigin(r),width:t.props.cardWidth,height:t.props.cardHeight,zIndex:3,perspective:"500px"},style:{width:t.props.cardWidth,height:t.props.cardHeight,border:"2px solid black"}}))}));return o.a.createElement("div",{className:U.a.Hand,style:{width:"".concat(this.props.cardWidth*this.props.widthRate,"px"),height:"".concat(this.props.cardHeight,"px")}},e)}}]),r}(o.a.Component),z=Object(E.b)((function(t){var e=t.cards.hand.findIndex((function(e){var r;return e.key===(null===(r=t.cards.pickedCard)||void 0===r?void 0:r.key)})),r=t.cards.hand.length-(-1!==e),n=function(t){switch(t){case 1:case 2:return 7;case 3:case 4:return 4;case 5:case 6:return 3;default:return 2}}(r);return{cards:t.cards.hand,pickedIndex:e,cardCount:r,cardGrid:t.cards.cardGrid,cardOverflow:n,focusedCard:t.cards.focusedCard,cardWidth:t.cards.cardWidth,cardHeight:t.cards.cardWidth*t.cards.cardRatio,widthRate:1+(r-1)*n/t.cards.cardGrid,deckPosition:t.cards.deckPosition}}))(X),Y=r(9),L=r.n(Y),K=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){var t;Object(d.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).setRef=function(e){t.card=e},t.setPosition=function(){var e=t.card.getBoundingClientRect();t.props.setDeckPosition({x:e.left,y:e.top})},t}return Object(s.a)(r,[{key:"componentDidMount",value:function(){this.setPosition(),this._setPosition=R(this.setPosition),window.addEventListener("resize",this._setPosition)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._setPosition)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(A,{hasBackface:!0,passProps:{ref:this.setRef},containerStyle:{margin:"1em 0",boxShadow:this.props.boxShadow},style:{border:"none",width:this.props.cardWidth,height:this.props.cardHeight,transform:"rotateY(180deg)"}}))}}]),r}(o.a.Component),V=function(t,e){var r=e<10?e:Math.floor(Math.max(10,e/2));return Array(r).fill().map((function(e,r){var n=r%2===0?t:"0 0.65px";return r=Math.floor(r/2)+1,"-".concat(r,"px ").concat(r,"px ").concat(n)})).join()},G=Object(E.b)((function(t){return{cardWidth:t.cards.cardWidth,cardHeight:t.cards.cardWidth*t.cards.cardRatio,empty:0===t.cards.deck.length,boxShadow:V(t.cards.cardShadowColor,t.cards.deck.length)}}),(function(t){return{drawCard:function(){return t(w.drawCard())},unpickCard:function(){return t(w.unpickCard())},setDeckPosition:function(e){return t(w.setDeckPosition(e))}}}))(K),J=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){return Object(d.a)(this,r),e.apply(this,arguments)}return Object(s.a)(r,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:L.a.BottomPane},o.a.createElement("div",{className:L.a.Container}," MANA STUFF "),o.a.createElement("div",{className:L.a.Container,style:{alignSelf:"flex-end",zIndex:2}},o.a.createElement(z,null)),o.a.createElement("div",{className:L.a.Container},o.a.createElement(G,null))))}}]),r}(o.a.Component),q=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){var t;Object(d.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).mouseMove=function(e){t.props.pickedCard&&(e.persist(),t.props.moveCard(e.pageX,e.pageY),t.props.resetRotation())},t.mouseUp=function(){t.props.pickedCard&&t.props.unpickCard()},t}return Object(s.a)(r,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{onMouseMove:this.mouseMove,onMouseUp:this.mouseUp,className:h.a.Scene},o.a.createElement("div",null,o.a.createElement("button",{onClick:this.props.drawCard},"Draw Card")),o.a.createElement(I,null),o.a.createElement(J,null)),this.props.pickedCard&&o.a.createElement(A,{info:this.props.pickedCard,containerStyle:{position:"fixed",left:this.props.pickedCardPosition.x,top:this.props.pickedCardPosition.y,pointerEvents:"none"},style:{width:this.props.pickedCardWidth,height:this.props.pickedCardHeight,transform:this.props.pickedCardRotation}}))}}]),r}(o.a.Component),Q=Object(E.b)((function(t){return{pickedCard:t.cards.pickedCard,pickedCardWidth:t.cards.pickedCardWidth,pickedCardHeight:t.cards.pickedCardWidth*t.cards.cardRatio,pickedCardPosition:t.cards.pickedCardPosition,pickedCardRotation:"rotateX(".concat(t.cards.pickedCardRotation.x,"deg) rotateY(").concat(t.cards.pickedCardRotation.y,"deg)")}}),(function(t){return{drawCard:function(){return t(w.drawCard())},unpickCard:function(){return t(w.unpickCard())},moveCard:R((function(e,r){return t(w.moveCard(e,r))})),resetRotation:B((function(){t(w.resetRotation())}),120)}}))(q),Z=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){return Object(d.a)(this,r),e.apply(this,arguments)}return Object(s.a)(r,[{key:"render",value:function(){return o.a.createElement(Q,null)}}]),r}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var $=r(8);function tt(t,e){return Object(f.a)(Object(f.a)({},t),e)}var et=Array(30).fill().map((function(t,e){return{key:e,title:"".concat(e,". card")}})),rt={x:15,y:0},nt={deck:et,hand:[],board:[],cardGrid:6,cardWidth:100,cardRatio:1.5,focusedCard:null,pickedCard:null,pickedCardPosition:null,pickedCardRotation:rt,pickedCardWidth:120,fakeCardIndex:null,cardShadowColor:"red",deckPosition:{x:0,y:0}};function at(t){if(9===t.hand.length||0===t.deck.length)return t;var e=Math.floor(Math.random()*t.deck.length),r=t.deck[e];return tt(t,{deck:[].concat(Object(_.a)(t.deck.slice(0,e)),Object(_.a)(t.deck.slice(e+1))),hand:t.hand.concat(r)})}function ot(t){return tt(t,{pickedCard:t.focusedCard,focusedCard:null})}function it(t,e){var r=e.x-t.pickedCardWidth/2,n=e.y-t.pickedCardWidth*t.cardRatio/2,a=t.pickedCardPosition?r-t.pickedCardPosition.x:0,o=t.pickedCardPosition?n-t.pickedCardPosition.y:0;return tt(t,{pickedCardPosition:{x:r,y:n},pickedCardRotation:{x:rt.x+H(1.5*-o,-30,30),y:rt.y+H(1.5*a,-30,30)}})}function ct(t){return tt(t,{pickedCard:null,pickedCardPosition:null,pickedCardRotation:rt,fakeCardIndex:null})}function dt(t){return 5===t.board.length?ct(t):tt(t,{board:[].concat(Object(_.a)(t.board.slice(0,t.fakeCardIndex)),[t.pickedCard],Object(_.a)(t.board.slice(t.fakeCardIndex))),hand:t.hand.filter((function(e){return e.key!==t.pickedCard.key})),pickedCard:null,pickedCardPosition:null,pickedCardRotation:rt,fakeCardIndex:null})}var st=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"DRAW_CARD":return at(t);case"FOCUS_CARD":return tt(t,{focusedCard:e.card});case"PICK_CARD":return ot(t);case"UNPICK_CARD":return ct(t);case"MOVE_CARD":return it(t,e);case"RESET_ROTATION":return tt(t,{pickedCardRotation:rt});case"MOVE_FAKE_CARD":return tt(t,{fakeCardIndex:e.index});case"PUT_CARD":return dt(t);case"SET_DECK_POSITION":return tt(t,{deckPosition:e.position});default:return t}},pt=Object($.b)({cards:st}),ut=Object($.c)(pt,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(E.a,{store:ut},o.a.createElement(Z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[20,1,2]]]);
//# sourceMappingURL=main.ce3d753f.chunk.js.map